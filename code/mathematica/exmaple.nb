(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     24850,        600]
NotebookOptionsPosition[     23609,        556]
NotebookOutlinePosition[     23942,        571]
CellTagsIndexPosition[     23899,        568]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{"bits", ":=", "5"}], "\[IndentingNewLine]", 
 RowBox[{"r", "=", 
  RowBox[{"RandomInteger", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"2", "^", 
      RowBox[{"(", 
       RowBox[{"bits", "-", "1"}], ")"}]}], ",", 
     RowBox[{"2", "^", "bits"}]}], "}"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"r", "=", "4"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"listProduct", "[", "x_List", "]"}], ":=", 
  RowBox[{"Times", "@@", "x"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"listSum", "[", "x_List", "]"}], ":=", 
  RowBox[{"Plus", "@@", "x"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"primeInf", "[", "x_", "]"}], ":=", 
  RowBox[{"Prime", "@", 
   RowBox[{"Range", "@", 
    RowBox[{"PrimePi", "@", "x"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"primes", ":=", 
  RowBox[{"primeInf", "[", "7", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"primesProduct", "=", 
  RowBox[{"listProduct", "[", "primes", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BitLength", "[", "primesProduct", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rModx", "[", "x_", "]"}], ":=", 
  RowBox[{"Mod", "[", 
   RowBox[{"r", ",", "x"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"rModPrimes", "=", 
  RowBox[{"Map", "[", 
   RowBox[{"rModx", ",", "primes"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"testChinese", ":=", 
  RowBox[{"ChineseRemainder", "[", 
   RowBox[{"rModPrimes", ",", "primes"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"uncertainty", ":=", "3"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uncertaintyMin", "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Floor", "[", 
    RowBox[{"x", "/", "uncertainty"}], "]"}], "*", 
   "uncertainty"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uncertaintyMax", "[", "x_", "]"}], ":=", 
  RowBox[{"Min", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Floor", "[", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{"rModPrimes", ",", "x"}], "]"}], "/", "uncertainty"}], 
         "]"}], "+", "1"}], ")"}], "*", "uncertainty"}], "-", "1"}], ",", 
    RowBox[{
     RowBox[{"Part", "[", 
      RowBox[{"primes", ",", "x"}], "]"}], "-", "1"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"minList", "=", 
  RowBox[{"Map", "[", 
   RowBox[{"uncertaintyMin", ",", " ", "rModPrimes"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"maxList", "=", 
  RowBox[{"Map", "[", 
   RowBox[{"uncertaintyMax", ",", " ", 
    RowBox[{"Range", "[", 
     RowBox[{"1", ",", 
      RowBox[{"Length", "[", "primes", "]"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7399700514114733`*^9, 3.73997012481929*^9}, {
   3.739970195408297*^9, 3.739970244196229*^9}, {3.739970475105612*^9, 
   3.7399704935616283`*^9}, {3.739970623552009*^9, 3.739970625677619*^9}, {
   3.7399707871369762`*^9, 3.739970818609304*^9}, {3.7399709212534437`*^9, 
   3.739970975268293*^9}, {3.739971470351802*^9, 3.7399714751906767`*^9}, {
   3.739971539393113*^9, 3.739971898912394*^9}, {3.739971997373521*^9, 
   3.739972008862227*^9}, {3.739972262820538*^9, 3.739972446602528*^9}, {
   3.73997248726339*^9, 3.739972509905905*^9}, {3.7399726259916697`*^9, 
   3.7399726736675463`*^9}, {3.739973196901369*^9, 3.739973203115849*^9}, 
   3.7399734364353733`*^9, {3.7399736726033087`*^9, 3.739973681327202*^9}, {
   3.7399738551395817`*^9, 3.7399738553175373`*^9}, {3.739973950656494*^9, 
   3.739974048235136*^9}, {3.7399740978360767`*^9, 3.73997413922849*^9}, {
   3.739974178562614*^9, 3.739974258171111*^9}, {3.739974288478458*^9, 
   3.73997433248319*^9}, {3.739974409176589*^9, 3.7399744092874813`*^9}, {
   3.739974462925322*^9, 3.7399745146526613`*^9}, {3.739974546427394*^9, 
   3.739974546505416*^9}, 3.739974604964238*^9, 3.7399746442429667`*^9, {
   3.739974856994746*^9, 3.7399748615377493`*^9}, {3.7399750768546553`*^9, 
   3.739975092095016*^9}, {3.739975305944371*^9, 3.7399753112995577`*^9}, 
   3.7399753674583063`*^9, {3.739975450163245*^9, 3.73997545529668*^9}, {
   3.739975516056757*^9, 3.739975572785863*^9}, {3.739975644279428*^9, 
   3.7399756445648613`*^9}, {3.7399756754235563`*^9, 
   3.7399757089637327`*^9}, {3.73997575782808*^9, 3.73997575808709*^9}, {
   3.7399758042990522`*^9, 3.739975820565056*^9}, {3.739987001782957*^9, 
   3.739987008325405*^9}, {3.739988501037963*^9, 3.73998850329784*^9}, {
   3.7399885731815157`*^9, 3.7399885904850273`*^9}, {3.739988625895172*^9, 
   3.7399886859041758`*^9}, {3.739988751202817*^9, 3.739988751355508*^9}, {
   3.7399895841928596`*^9, 3.7399895842939157`*^9}, {3.739990288599401*^9, 
   3.739990302489603*^9}, {3.739990779171351*^9, 3.739990779258114*^9}, {
   3.7399932193606787`*^9, 3.7399932194794703`*^9}, 3.73999616130238*^9, {
   3.7399967806675653`*^9, 3.739996780849588*^9}, 3.739996820421954*^9, {
   3.739997578377631*^9, 3.739997578574193*^9}, {3.739997782867229*^9, 
   3.7399977832983828`*^9}, {3.7399978219168787`*^9, 
   3.7399978726981163`*^9}, {3.7399980084284353`*^9, 3.739998011369553*^9}, 
   3.739998057328621*^9, {3.739998300444113*^9, 3.739998354830216*^9}, {
   3.7399984814511843`*^9, 3.7399984929873333`*^9}, 3.7399987285632467`*^9, {
   3.7399987615114*^9, 3.739998797540265*^9}, {3.7399989944130583`*^9, 
   3.739999009195887*^9}, {3.740000080379879*^9, 3.740000081145893*^9}, {
   3.740000244206758*^9, 3.740000267475729*^9}, {3.7403989925132227`*^9, 
   3.740398994018567*^9}, {3.7403990262009993`*^9, 3.740399027935677*^9}}],

Cell[BoxData["18"], "Output",
 CellChangeTimes->{
  3.7399979189031153`*^9, {3.739997993708981*^9, 3.739998040974021*^9}, 
   3.739998071440049*^9, {3.7399984559791*^9, 3.7399984945609713`*^9}, {
   3.739998666625705*^9, 3.739998685899147*^9}, 3.739998729543048*^9, {
   3.73999876388097*^9, 3.739998798004263*^9}, {3.7399989980601873`*^9, 
   3.739999009662879*^9}, 3.740000083907226*^9, {3.740000245239951*^9, 
   3.740000268105061*^9}, 3.740399031256625*^9, 3.7404017416269407`*^9}],

Cell[BoxData["4"], "Output",
 CellChangeTimes->{
  3.7399979189031153`*^9, {3.739997993708981*^9, 3.739998040974021*^9}, 
   3.739998071440049*^9, {3.7399984559791*^9, 3.7399984945609713`*^9}, {
   3.739998666625705*^9, 3.739998685899147*^9}, 3.739998729543048*^9, {
   3.73999876388097*^9, 3.739998798004263*^9}, {3.7399989980601873`*^9, 
   3.739999009662879*^9}, 3.740000083907226*^9, {3.740000245239951*^9, 
   3.740000268105061*^9}, 3.740399031256625*^9, 3.740401741629468*^9}],

Cell[BoxData["210"], "Output",
 CellChangeTimes->{
  3.7399979189031153`*^9, {3.739997993708981*^9, 3.739998040974021*^9}, 
   3.739998071440049*^9, {3.7399984559791*^9, 3.7399984945609713`*^9}, {
   3.739998666625705*^9, 3.739998685899147*^9}, 3.739998729543048*^9, {
   3.73999876388097*^9, 3.739998798004263*^9}, {3.7399989980601873`*^9, 
   3.739999009662879*^9}, 3.740000083907226*^9, {3.740000245239951*^9, 
   3.740000268105061*^9}, 3.740399031256625*^9, 3.740401741632494*^9}],

Cell[BoxData["8"], "Output",
 CellChangeTimes->{
  3.7399979189031153`*^9, {3.739997993708981*^9, 3.739998040974021*^9}, 
   3.739998071440049*^9, {3.7399984559791*^9, 3.7399984945609713`*^9}, {
   3.739998666625705*^9, 3.739998685899147*^9}, 3.739998729543048*^9, {
   3.73999876388097*^9, 3.739998798004263*^9}, {3.7399989980601873`*^9, 
   3.739999009662879*^9}, 3.740000083907226*^9, {3.740000245239951*^9, 
   3.740000268105061*^9}, 3.740399031256625*^9, 3.740401741635418*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "1", ",", "4", ",", "4"}], "}"}]], "Output",
 CellChangeTimes->{
  3.7399979189031153`*^9, {3.739997993708981*^9, 3.739998040974021*^9}, 
   3.739998071440049*^9, {3.7399984559791*^9, 3.7399984945609713`*^9}, {
   3.739998666625705*^9, 3.739998685899147*^9}, 3.739998729543048*^9, {
   3.73999876388097*^9, 3.739998798004263*^9}, {3.7399989980601873`*^9, 
   3.739999009662879*^9}, 3.740000083907226*^9, {3.740000245239951*^9, 
   3.740000268105061*^9}, 3.740399031256625*^9, 3.7404017416383743`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "3", ",", "3"}], "}"}]], "Output",
 CellChangeTimes->{
  3.7399979189031153`*^9, {3.739997993708981*^9, 3.739998040974021*^9}, 
   3.739998071440049*^9, {3.7399984559791*^9, 3.7399984945609713`*^9}, {
   3.739998666625705*^9, 3.739998685899147*^9}, 3.739998729543048*^9, {
   3.73999876388097*^9, 3.739998798004263*^9}, {3.7399989980601873`*^9, 
   3.739999009662879*^9}, 3.740000083907226*^9, {3.740000245239951*^9, 
   3.740000268105061*^9}, 3.740399031256625*^9, 3.7404017416415653`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "2", ",", "4", ",", "5"}], "}"}]], "Output",
 CellChangeTimes->{
  3.7399979189031153`*^9, {3.739997993708981*^9, 3.739998040974021*^9}, 
   3.739998071440049*^9, {3.7399984559791*^9, 3.7399984945609713`*^9}, {
   3.739998666625705*^9, 3.739998685899147*^9}, 3.739998729543048*^9, {
   3.73999876388097*^9, 3.739998798004263*^9}, {3.7399989980601873`*^9, 
   3.739999009662879*^9}, 3.740000083907226*^9, {3.740000245239951*^9, 
   3.740000268105061*^9}, 3.740399031256625*^9, 3.7404017416447372`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"listProductGCD", "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Part", "[", 
    RowBox[{
     RowBox[{"Part", "[", 
      RowBox[{
       RowBox[{"ExtendedGCD", "[", 
        RowBox[{
         RowBox[{"primesProduct", "/", "x"}], ",", "x"}], "]"}], ",", "2"}], 
      "]"}], ",", "1"}], "]"}], "*", 
   RowBox[{"(", 
    RowBox[{"primesProduct", "/", "x"}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"GCDValuesPrimes", "=", 
  RowBox[{"Map", "[", 
   RowBox[{"listProductGCD", ",", "primes"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GetExPression", "[", "i_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Part", "[", 
    RowBox[{"minList", ",", "i"}], "]"}], " ", "<=", 
   RowBox[{"Symbol", "[", 
    RowBox[{"\"\<a\>\"", "<>", 
     RowBox[{"ToString", "[", "i", "]"}]}], "]"}], " ", "<=", 
   RowBox[{"Part", "[", 
    RowBox[{"maxList", ",", "i"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"expressions", ":=", 
  RowBox[{"Map", "[", 
   RowBox[{"GetExPression", ",", 
    RowBox[{"Range", "[", 
     RowBox[{"1", ",", 
      RowBox[{"Length", "[", "minList", "]"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"makeVariable", "[", "i_", "]"}], ":=", 
  RowBox[{"Symbol", "[", 
   RowBox[{"\"\<a\>\"", "<>", 
    RowBox[{"ToString", "[", "i", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"usedVariables", ":=", 
  RowBox[{"Map", "[", 
   RowBox[{"makeVariable", ",", 
    RowBox[{"Range", "[", 
     RowBox[{"1", ",", 
      RowBox[{"Length", "[", "minList", "]"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"maxValue", " ", ":=", " ", 
  RowBox[{"2", "^", "bits"}]}], "\[IndentingNewLine]", 
 RowBox[{"allExpressions", "=", 
  RowBox[{"Append", "[", 
   RowBox[{
    RowBox[{"Append", "[", 
     RowBox[{
      RowBox[{"Append", "[", 
       RowBox[{"expressions", ",", 
        RowBox[{"x", "==", 
         RowBox[{"Mod", "[", 
          RowBox[{
           RowBox[{"listSum", "[", 
            RowBox[{"usedVariables", "*", "GCDValuesPrimes"}], "]"}], ",", 
           "primesProduct"}], "]"}]}]}], "]"}], ",", 
      RowBox[{"x", "<", "maxValue"}]}], "]"}], ",", 
    RowBox[{"x", ">", "0"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"sol", "=", 
  RowBox[{"Timing", "[", 
   RowBox[{"FindInstance", "[", 
    RowBox[{"allExpressions", ",", 
     RowBox[{"Append", "[", 
      RowBox[{"usedVariables", ",", "x"}], "]"}], ",", " ", "Integers"}], 
    "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"res", ":=", 
  RowBox[{"Mod", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Last", "[", 
      RowBox[{
       RowBox[{"sol", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}], ",", "primesProduct"}], 
   "]"}]}], "\[IndentingNewLine]", "res", "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.73997230497052*^9, 3.739972312910481*^9}, 
   3.739972586098065*^9, 3.739972633984931*^9, {3.739972704816166*^9, 
   3.739972717044156*^9}, {3.739972750373204*^9, 3.739972750702417*^9}, {
   3.739972806420573*^9, 3.739972808603415*^9}, {3.739973213868781*^9, 
   3.739973284852085*^9}, {3.7399733162247047`*^9, 3.7399733166337137`*^9}, 
   3.7399733716883698`*^9, {3.739973407884491*^9, 3.73997348085211*^9}, {
   3.739973696606958*^9, 3.739973705993524*^9}, 3.739973807286479*^9, 
   3.7399739023157263`*^9, {3.739974442198268*^9, 3.739974446460585*^9}, {
   3.739974768571959*^9, 3.739974803169393*^9}, {3.739974953374798*^9, 
   3.739974985028227*^9}, {3.739975048903211*^9, 3.739975063586234*^9}, {
   3.7399753373938713`*^9, 3.739975338789919*^9}, {3.739975389987277*^9, 
   3.739975417759425*^9}, {3.739975468936008*^9, 3.7399754706760902`*^9}, {
   3.739985168081506*^9, 3.739985168824538*^9}, {3.739987049117668*^9, 
   3.739987064009529*^9}, {3.739989076017014*^9, 3.739989196660079*^9}, {
   3.7399892370122557`*^9, 3.739989240869546*^9}, {3.739989446202984*^9, 
   3.739989538745515*^9}, {3.739989594053088*^9, 3.739989606421795*^9}, {
   3.7399897614013233`*^9, 3.739989776750372*^9}, {3.7399898128246*^9, 
   3.739989813221504*^9}, {3.739989850238654*^9, 3.73998986287882*^9}, {
   3.739989907389559*^9, 3.739989909173902*^9}, {3.739989951078575*^9, 
   3.739990128706705*^9}, {3.739990185577704*^9, 3.739990201695496*^9}, {
   3.739990233691327*^9, 3.7399902740806932`*^9}, {3.739990340209989*^9, 
   3.7399903532390757`*^9}, 3.7399904246674623`*^9, {3.739996054494598*^9, 
   3.73999606660632*^9}, {3.7399963163333597`*^9, 3.739996331054718*^9}, 
   3.739996779192635*^9, {3.7399968239589853`*^9, 3.739996824354576*^9}, 
   3.739997696803871*^9, 3.739997780924663*^9, 3.739998059369488*^9, {
   3.7399981201679688`*^9, 3.7399981205367603`*^9}, {3.739998429482856*^9, 
   3.7399984462284517`*^9}, {3.739998568474885*^9, 3.739998568814283*^9}, {
   3.739998625742433*^9, 3.739998651822226*^9}, {3.739998812607397*^9, 
   3.739998834225415*^9}, {3.739999089041608*^9, 3.739999089244544*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"105", ",", "70", ",", 
   RowBox[{"-", "84"}], ",", 
   RowBox[{"-", "90"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7399980737655993`*^9, 3.7399981311978817`*^9, 3.739998506260998*^9, 
   3.739998571832498*^9, {3.739998628566618*^9, 3.739998692961931*^9}, {
   3.739998772627508*^9, 3.739998818922409*^9}, 3.7399989160686483`*^9, {
   3.739999001883897*^9, 3.7399990127579117`*^9}, 3.739999089789307*^9, 
   3.740000114283162*^9, 3.7400002922381287`*^9, 3.740399042731873*^9, 
   3.740401743639483*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0", "\[LessEqual]", "a1", "\[LessEqual]", "1"}], ",", 
   RowBox[{"0", "\[LessEqual]", "a2", "\[LessEqual]", "2"}], ",", 
   RowBox[{"3", "\[LessEqual]", "a3", "\[LessEqual]", "4"}], ",", 
   RowBox[{"3", "\[LessEqual]", "a4", "\[LessEqual]", "5"}], ",", 
   RowBox[{"x", "\[Equal]", 
    RowBox[{"Mod", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"105", " ", "a1"}], "+", 
       RowBox[{"70", " ", "a2"}], "-", 
       RowBox[{"84", " ", "a3"}], "-", 
       RowBox[{"90", " ", "a4"}]}], ",", "210"}], "]"}]}], ",", 
   RowBox[{"x", "<", "32"}], ",", 
   RowBox[{"x", ">", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7399980737655993`*^9, 3.7399981311978817`*^9, 3.739998506260998*^9, 
   3.739998571832498*^9, {3.739998628566618*^9, 3.739998692961931*^9}, {
   3.739998772627508*^9, 3.739998818922409*^9}, 3.7399989160686483`*^9, {
   3.739999001883897*^9, 3.7399990127579117`*^9}, 3.739999089789307*^9, 
   3.740000114283162*^9, 3.7400002922381287`*^9, 3.740399042731873*^9, 
   3.740401743643064*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.06400000000000000133226762955018784851`4.826779887263512", ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a1", "\[Rule]", "0"}], ",", 
      RowBox[{"a2", "\[Rule]", "1"}], ",", 
      RowBox[{"a3", "\[Rule]", "4"}], ",", 
      RowBox[{"a4", "\[Rule]", "4"}], ",", 
      RowBox[{"x", "\[Rule]", "4"}]}], "}"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7399980737655993`*^9, 3.7399981311978817`*^9, 3.739998506260998*^9, 
   3.739998571832498*^9, {3.739998628566618*^9, 3.739998692961931*^9}, {
   3.739998772627508*^9, 3.739998818922409*^9}, 3.7399989160686483`*^9, {
   3.739999001883897*^9, 3.7399990127579117`*^9}, 3.739999089789307*^9, 
   3.740000114283162*^9, 3.7400002922381287`*^9, 3.740399042731873*^9, 
   3.740401743719885*^9}],

Cell[BoxData["4"], "Output",
 CellChangeTimes->{
  3.7399980737655993`*^9, 3.7399981311978817`*^9, 3.739998506260998*^9, 
   3.739998571832498*^9, {3.739998628566618*^9, 3.739998692961931*^9}, {
   3.739998772627508*^9, 3.739998818922409*^9}, 3.7399989160686483`*^9, {
   3.739999001883897*^9, 3.7399990127579117`*^9}, 3.739999089789307*^9, 
   3.740000114283162*^9, 3.7400002922381287`*^9, 3.740399042731873*^9, 
   3.740401743723754*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"getValue", "[", "x_", "]"}], ":=", 
    RowBox[{"x", "[", 
     RowBox[{"[", "2", "]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"multVec", ":=", 
    RowBox[{"Map", "[", 
     RowBox[{"getValue", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"sol", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{
             RowBox[{"sol", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", "1"}], ")"}]}], 
        "]"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"listSum", "[", 
    RowBox[{"multVec", "*", "GCDValuesPrimes"}], "]"}], "\[IndentingNewLine]",
    "primesProduct", "\[IndentingNewLine]", 
   RowBox[{"Mod", "[", 
    RowBox[{
     RowBox[{"listSum", "[", 
      RowBox[{"multVec", "*", "GCDValuesPrimes"}], "]"}], ",", 
     "primesProduct"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7399904447483873`*^9, 3.739990450938738*^9}, {
  3.739990484730234*^9, 3.739990526547451*^9}, {3.739990585754355*^9, 
  3.739990737628521*^9}, {3.739991008270792*^9, 3.739991012122364*^9}}],

Cell[BoxData["135863557849"], "Output",
 CellChangeTimes->{
  3.7399905334417953`*^9, {3.7399906087622137`*^9, 3.739990694388171*^9}, 
   3.739990746872548*^9, 3.739990786985177*^9, 3.739991013263435*^9}],

Cell[BoxData["6469693230"], "Output",
 CellChangeTimes->{
  3.7399905334417953`*^9, {3.7399906087622137`*^9, 3.739990694388171*^9}, 
   3.739990746872548*^9, 3.739990786985177*^9, 3.739991013271352*^9}],

Cell[BoxData["19"], "Output",
 CellChangeTimes->{
  3.7399905334417953`*^9, {3.7399906087622137`*^9, 3.739990694388171*^9}, 
   3.739990746872548*^9, 3.739990786985177*^9, 3.739991013278184*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"maxValue", ":=", 
  RowBox[{"2", "^", "bits"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GetModExpression", "[", "m_", "]"}], " ", ":=", 
  RowBox[{
   RowBox[{"Mod", "[", 
    RowBox[{
     RowBox[{"x", " ", "-", " ", "c"}], ",", "m"}], "]"}], "\[LessEqual]", 
   "uncertainty"}]}], "\[IndentingNewLine]", 
 RowBox[{"modExpressions", ":=", 
  RowBox[{"Map", "[", 
   RowBox[{"GetModExpression", ",", " ", "primes"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"newExpressions", "=", 
  RowBox[{"Append", "[", 
   RowBox[{
    RowBox[{"Append", "[", 
     RowBox[{
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"Append", "[", 
         RowBox[{"modExpressions", ",", 
          RowBox[{"0", ">=", "x"}]}], "]"}], ",", 
        RowBox[{"x", "<", "maxValue"}]}], "]"}], ",", 
      RowBox[{"c", "\[NotEqual]", "0"}]}], "]"}], ",", " ", 
    RowBox[{"c", "\[LessEqual]", "7"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"sol", "=", 
  RowBox[{"Timing", "[", 
   RowBox[{"FindInstance", "[", 
    RowBox[{"newExpressions", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "c"}], "}"}], ",", " ", "Integers"}], "]"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.7403994894772873`*^9, 3.740399571649941*^9}, {
   3.740399607806785*^9, 3.740399626311314*^9}, {3.740399658701473*^9, 
   3.740399716407536*^9}, {3.74039975368591*^9, 3.7403998034945927`*^9}, {
   3.740399837915732*^9, 3.7403998392581177`*^9}, {3.7403998938720293`*^9, 
   3.7403999283180943`*^9}, {3.740399962231081*^9, 3.740399979600089*^9}, {
   3.7404000641905823`*^9, 3.7404000937655*^9}, {3.740400253155707*^9, 
   3.740400273941062*^9}, {3.740400334278223*^9, 3.740400336021676*^9}, 
   3.740400438927932*^9, {3.7404004771295*^9, 3.74040049320337*^9}, {
   3.7404005393630743`*^9, 3.740400552449728*^9}, {3.7404006036389837`*^9, 
   3.74040060713763*^9}, {3.740401542907734*^9, 3.740401552179762*^9}, {
   3.740401691501121*^9, 3.74040172125813*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"Mod", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "c"}], "+", "x"}], ",", "2"}], "]"}], "\[LessEqual]", 
    "3"}], ",", 
   RowBox[{
    RowBox[{"Mod", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "c"}], "+", "x"}], ",", "3"}], "]"}], "\[LessEqual]", 
    "3"}], ",", 
   RowBox[{
    RowBox[{"Mod", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "c"}], "+", "x"}], ",", "5"}], "]"}], "\[LessEqual]", 
    "3"}], ",", 
   RowBox[{
    RowBox[{"Mod", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "c"}], "+", "x"}], ",", "7"}], "]"}], "\[LessEqual]", 
    "3"}], ",", 
   RowBox[{"0", "\[GreaterEqual]", "x"}], ",", 
   RowBox[{"x", "<", "32"}], ",", 
   RowBox[{"c", "\[NotEqual]", "0"}], ",", 
   RowBox[{"c", "\[LessEqual]", "7"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.740400096657576*^9, 3.740400278824872*^9, 3.7404003371902246`*^9, 
   3.7404004398091173`*^9, 3.7404004954547243`*^9, 3.740400553448922*^9, 
   3.740400608944867*^9, 3.7404015533634977`*^9, {3.7404017353677998`*^9, 
   3.740401748026963*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.14399999999999998911981435867346590385`5.1789624053748735", ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x", "\[Rule]", 
       RowBox[{"-", "34"}]}], ",", 
      RowBox[{"c", "\[Rule]", "1"}]}], "}"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.740400096657576*^9, 3.740400278824872*^9, 3.7404003371902246`*^9, 
   3.7404004398091173`*^9, 3.7404004954547243`*^9, 3.740400553448922*^9, 
   3.740400608944867*^9, 3.7404015533634977`*^9, {3.7404017353677998`*^9, 
   3.740401748102016*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Mod", "[", 
  RowBox[{
   RowBox[{"-", "34"}], ",", "5"}], "]"}]], "Input",
 CellChangeTimes->{{3.740402035826188*^9, 3.740402042372884*^9}}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{3.740402043120019*^9}]
}, Open  ]]
},
WindowSize->{810, 1030},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.0 for Linux x86 (64-bit) (June 27, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 5521, 112, 473, "Input"],
Cell[6104, 136, 485, 7, 32, "Output"],
Cell[6592, 145, 482, 7, 32, "Output"],
Cell[7077, 154, 484, 7, 32, "Output"],
Cell[7564, 163, 482, 7, 32, "Output"],
Cell[8049, 172, 549, 9, 32, "Output"],
Cell[8601, 183, 549, 9, 32, "Output"],
Cell[9153, 194, 549, 9, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9739, 208, 5003, 110, 429, "Input"],
Cell[14745, 320, 547, 11, 32, "Output"],
Cell[15295, 333, 1070, 23, 55, "Output"],
Cell[16368, 358, 815, 17, 32, "Output"],
Cell[17186, 377, 439, 7, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17662, 389, 1346, 35, 143, "Input"],
Cell[19011, 426, 204, 3, 32, "Output"],
Cell[19218, 431, 202, 3, 32, "Output"],
Cell[19423, 436, 194, 3, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19654, 444, 1968, 44, 165, "Input"],
Cell[21625, 490, 1124, 35, 55, "Output"],
Cell[22752, 527, 566, 14, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23355, 546, 165, 4, 32, "Input"],
Cell[23523, 552, 70, 1, 32, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
