(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     13027,        299]
NotebookOptionsPosition[     12597,        280]
NotebookOutlinePosition[     12930,        295]
CellTagsIndexPosition[     12887,        292]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"primeInf", "[", "x_", "]"}], ":=", 
  RowBox[{"Prime", "@", 
   RowBox[{"Range", "@", 
    RowBox[{"PrimePi", "@", "x"}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"listProduct", "[", "x_List", "]"}], ":=", 
  RowBox[{"Times", "@@", "x"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"listSum", "[", "x_List", "]"}], ":=", 
  RowBox[{"Plus", "@@", "x"}]}], "\[IndentingNewLine]", 
 RowBox[{"primes", ":=", 
  RowBox[{"primeInf", "@", 
   RowBox[{"(", "11", ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"primesProduct", ":=", 
  RowBox[{"listProduct", "[", "primes", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"possibleBits", ":=", 
  RowBox[{"BitLength", "[", "primesProduct", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"perfectCaseBits", " ", ":=", " ", 
  RowBox[{"possibleBits", " ", "-", " ", 
   RowBox[{"7", "*", 
    RowBox[{"Length", "[", "primes", "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"listProductGCD", "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Part", "[", 
    RowBox[{
     RowBox[{"Part", "[", 
      RowBox[{
       RowBox[{"ExtendedGCD", "[", 
        RowBox[{
         RowBox[{"primesProduct", "/", "x"}], ",", "x"}], "]"}], ",", "2"}], 
      "]"}], ",", "1"}], "]"}], "*", 
   RowBox[{"(", 
    RowBox[{"primesProduct", "/", "x"}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"GCDValuesPrimes", ":=", 
  RowBox[{"Map", "[", 
   RowBox[{"listProductGCD", ",", "primes"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"minList", ":=", 
  RowBox[{"{", 
   RowBox[{"0", ",", "1", ",", "0", ",", "3", ",", 
    RowBox[{"-", "1"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"maxList", ":=", 
  RowBox[{"{", 
   RowBox[{"2", ",", "3", ",", "2", ",", "5", ",", "2"}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GetExPression", "[", "i_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Part", "[", 
    RowBox[{"minList", ",", "i"}], "]"}], " ", "<", 
   RowBox[{"Symbol", "[", 
    RowBox[{"\"\<a\>\"", "<>", 
     RowBox[{"ToString", "[", "i", "]"}]}], "]"}], " ", "<", 
   RowBox[{"Part", "[", 
    RowBox[{"maxList", ",", "i"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"expressions", ":=", 
  RowBox[{"Map", "[", 
   RowBox[{"GetExPression", ",", 
    RowBox[{"Range", "[", 
     RowBox[{"1", ",", 
      RowBox[{"Length", "[", "minList", "]"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"makeVariable", "[", "i_", "]"}], ":=", 
  RowBox[{"Symbol", "[", 
   RowBox[{"\"\<a\>\"", "<>", 
    RowBox[{"ToString", "[", "i", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"usedVariables", ":=", 
  RowBox[{"Map", "[", 
   RowBox[{"makeVariable", ",", 
    RowBox[{"Range", "[", 
     RowBox[{"1", ",", 
      RowBox[{"Length", "[", "minList", "]"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"calcMi", "[", "x_", "]"}], ":=", 
  RowBox[{"GCDValuesPrimes", "/", "x"}]}], "\[IndentingNewLine]", 
 RowBox[{"listSum", "[", 
  RowBox[{"usedVariables", "*", "GCDValuesPrimes"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"maxValue", " ", ":=", " ", "11000"}], "\[IndentingNewLine]", 
 RowBox[{"allExpressions", ":=", 
  RowBox[{"Append", "[", 
   RowBox[{
    RowBox[{"Append", "[", 
     RowBox[{
      RowBox[{"Append", "[", 
       RowBox[{"expressions", ",", 
        RowBox[{"x", "==", 
         RowBox[{"Mod", "[", 
          RowBox[{
           RowBox[{"listSum", "[", 
            RowBox[{"usedVariables", "*", "GCDValuesPrimes"}], "]"}], ",", 
           "primesProduct"}], "]"}]}]}], "]"}], ",", 
      RowBox[{"x", "<", "maxValue"}]}], "]"}], ",", 
    RowBox[{"x", ">", "0"}]}], 
   "]"}]}], "\[IndentingNewLine]", "allExpressions", "\[IndentingNewLine]", 
 RowBox[{"FindInstance", "[", 
  RowBox[{"allExpressions", ",", 
   RowBox[{"Append", "[", 
    RowBox[{"usedVariables", ",", "x"}], "]"}], ",", " ", "Integers"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Solve", "[", 
  RowBox[{"allExpressions", ",", 
   RowBox[{"Append", "[", 
    RowBox[{"usedVariables", ",", "x"}], "]"}], ",", " ", "Integers"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.7398780670220013`*^9, 3.739878101508835*^9}, {
   3.739878131585463*^9, 3.7398781637468557`*^9}, {3.7398783736094007`*^9, 
   3.739878403647443*^9}, {3.739878541375554*^9, 3.739878645646084*^9}, {
   3.739878721386806*^9, 3.739878732014229*^9}, {3.739878828032629*^9, 
   3.7398788308296623`*^9}, {3.7398789362279997`*^9, 3.739878937756744*^9}, {
   3.7398790011399803`*^9, 3.739879038155308*^9}, {3.739879073194138*^9, 
   3.739879092819395*^9}, {3.739879157204975*^9, 3.739879193739751*^9}, {
   3.739879262749189*^9, 3.7398792698307667`*^9}, {3.7398793813746023`*^9, 
   3.739879452236765*^9}, {3.739879587354991*^9, 3.7398796475446377`*^9}, {
   3.739879849060585*^9, 3.7398798895580883`*^9}, {3.7398799953659267`*^9, 
   3.7398800462872953`*^9}, {3.739880129757697*^9, 3.739880129948401*^9}, {
   3.739880184645578*^9, 3.739880187158009*^9}, {3.7398802873601913`*^9, 
   3.739880287507625*^9}, {3.739880709308608*^9, 3.739880718636557*^9}, {
   3.7398807531101313`*^9, 3.739880759814928*^9}, {3.739881750029325*^9, 
   3.7398818057947397`*^9}, {3.739883004637182*^9, 3.7398830387399*^9}, {
   3.739883440782064*^9, 3.739883455712916*^9}, {3.7398835061272097`*^9, 
   3.739883670958729*^9}, {3.7398837026559553`*^9, 3.739883748543868*^9}, {
   3.7398837789191732`*^9, 3.739883879867188*^9}, 3.739883948974349*^9, {
   3.739884015130484*^9, 3.7398840844057913`*^9}, {3.7398842382278347`*^9, 
   3.7398842383696127`*^9}, {3.7398843038575087`*^9, 
   3.7398843259452333`*^9}, {3.7398844133587017`*^9, 3.739884420717239*^9}, {
   3.739884461797757*^9, 3.7398844992348127`*^9}, {3.739884535877843*^9, 
   3.739884608338822*^9}, {3.739884658961465*^9, 3.73988469230678*^9}, 
   3.7398847456969852`*^9, {3.739884792368917*^9, 3.7398847928178577`*^9}, {
   3.739884834817431*^9, 3.7398848359899073`*^9}, {3.73988510855893*^9, 
   3.7398851337889338`*^9}, {3.7398852648987837`*^9, 
   3.7398853041017437`*^9}, {3.739885354835091*^9, 3.73988548924959*^9}, {
   3.7398855354168873`*^9, 3.7398855733717747`*^9}, {3.7398856497417173`*^9, 
   3.73988565206021*^9}, {3.739885687653329*^9, 3.7398857567268457`*^9}, {
   3.739886090200848*^9, 3.739886091157166*^9}, {3.739886131439424*^9, 
   3.739886135092194*^9}, {3.739886356408457*^9, 3.739886388088005*^9}, {
   3.739972598994216*^9, 3.739972603544813*^9}, {3.739973017863761*^9, 
   3.739973048106555*^9}, {3.739973121799034*^9, 3.739973161571666*^9}, {
   3.739974904223217*^9, 3.739974917754259*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"1155", " ", "a1"}], "-", 
  RowBox[{"770", " ", "a2"}], "-", 
  RowBox[{"924", " ", "a3"}], "+", 
  RowBox[{"330", " ", "a4"}], "+", 
  RowBox[{"210", " ", "a5"}]}]], "Output",
 CellChangeTimes->{
  3.739881806803417*^9, 3.7398837222032623`*^9, {3.739883752884822*^9, 
   3.739883812630443*^9}, 3.739883881023715*^9, 3.739883951014722*^9, 
   3.7398840851989326`*^9, 3.7398842388876257`*^9, {3.739884304883816*^9, 
   3.73988434421486*^9}, 3.739884422326973*^9, 3.739884548158079*^9, 
   3.739884623112905*^9, 3.7398846931312943`*^9, 3.739884746580182*^9, 
   3.739884794190772*^9, 3.739884836762892*^9, 3.7398851397407017`*^9, 
   3.7398853059409943`*^9, 3.73988537148225*^9, {3.739885413373145*^9, 
   3.739885450727726*^9}, {3.7398854900180483`*^9, 3.7398855025250587`*^9}, {
   3.739885552344411*^9, 3.739885575330546*^9}, 3.739885653860388*^9, 
   3.7398857242955227`*^9, 3.7398857580269823`*^9, 3.739886141990543*^9, 
   3.7398863597189093`*^9, 3.7398863916350737`*^9, 3.7398864296068363`*^9, 
   3.739972922612268*^9, {3.739974907112761*^9, 3.739974919810411*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0", "<", "a1", "<", "2"}], ",", 
   RowBox[{"1", "<", "a2", "<", "3"}], ",", 
   RowBox[{"0", "<", "a3", "<", "2"}], ",", 
   RowBox[{"3", "<", "a4", "<", "5"}], ",", 
   RowBox[{
    RowBox[{"-", "1"}], "<", "a5", "<", "2"}], ",", 
   RowBox[{"x", "\[Equal]", 
    RowBox[{"Mod", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"1155", " ", "a1"}], "-", 
       RowBox[{"770", " ", "a2"}], "-", 
       RowBox[{"924", " ", "a3"}], "+", 
       RowBox[{"330", " ", "a4"}], "+", 
       RowBox[{"210", " ", "a5"}]}], ",", "2310"}], "]"}]}], ",", 
   RowBox[{"x", "<", "11000"}], ",", 
   RowBox[{"x", ">", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.739881806803417*^9, 3.7398837222032623`*^9, {3.739883752884822*^9, 
   3.739883812630443*^9}, 3.739883881023715*^9, 3.739883951014722*^9, 
   3.7398840851989326`*^9, 3.7398842388876257`*^9, {3.739884304883816*^9, 
   3.73988434421486*^9}, 3.739884422326973*^9, 3.739884548158079*^9, 
   3.739884623112905*^9, 3.7398846931312943`*^9, 3.739884746580182*^9, 
   3.739884794190772*^9, 3.739884836762892*^9, 3.7398851397407017`*^9, 
   3.7398853059409943`*^9, 3.73988537148225*^9, {3.739885413373145*^9, 
   3.739885450727726*^9}, {3.7398854900180483`*^9, 3.7398855025250587`*^9}, {
   3.739885552344411*^9, 3.739885575330546*^9}, 3.739885653860388*^9, 
   3.7398857242955227`*^9, 3.7398857580269823`*^9, 3.739886141990543*^9, 
   3.7398863597189093`*^9, 3.7398863916350737`*^9, 3.7398864296068363`*^9, 
   3.739972922612268*^9, {3.739974907112761*^9, 3.739974919816764*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"a1", "\[Rule]", "1"}], ",", 
    RowBox[{"a2", "\[Rule]", "2"}], ",", 
    RowBox[{"a3", "\[Rule]", "1"}], ",", 
    RowBox[{"a4", "\[Rule]", "4"}], ",", 
    RowBox[{"a5", "\[Rule]", "0"}], ",", 
    RowBox[{"x", "\[Rule]", "11"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.739881806803417*^9, 3.7398837222032623`*^9, {3.739883752884822*^9, 
   3.739883812630443*^9}, 3.739883881023715*^9, 3.739883951014722*^9, 
   3.7398840851989326`*^9, 3.7398842388876257`*^9, {3.739884304883816*^9, 
   3.73988434421486*^9}, 3.739884422326973*^9, 3.739884548158079*^9, 
   3.739884623112905*^9, 3.7398846931312943`*^9, 3.739884746580182*^9, 
   3.739884794190772*^9, 3.739884836762892*^9, 3.7398851397407017`*^9, 
   3.7398853059409943`*^9, 3.73988537148225*^9, {3.739885413373145*^9, 
   3.739885450727726*^9}, {3.7398854900180483`*^9, 3.7398855025250587`*^9}, {
   3.739885552344411*^9, 3.739885575330546*^9}, 3.739885653860388*^9, 
   3.7398857242955227`*^9, 3.7398857580269823`*^9, 3.739886141990543*^9, 
   3.7398863597189093`*^9, 3.7398863916350737`*^9, 3.7398864296068363`*^9, 
   3.739972922612268*^9, {3.739974907112761*^9, 3.7399749198486137`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a1", "\[Rule]", "1"}], ",", 
     RowBox[{"a2", "\[Rule]", "2"}], ",", 
     RowBox[{"a3", "\[Rule]", "1"}], ",", 
     RowBox[{"a4", "\[Rule]", "4"}], ",", 
     RowBox[{"a5", "\[Rule]", "0"}], ",", 
     RowBox[{"x", "\[Rule]", "11"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a1", "\[Rule]", "1"}], ",", 
     RowBox[{"a2", "\[Rule]", "2"}], ",", 
     RowBox[{"a3", "\[Rule]", "1"}], ",", 
     RowBox[{"a4", "\[Rule]", "4"}], ",", 
     RowBox[{"a5", "\[Rule]", "1"}], ",", 
     RowBox[{"x", "\[Rule]", "221"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.739881806803417*^9, 3.7398837222032623`*^9, {3.739883752884822*^9, 
   3.739883812630443*^9}, 3.739883881023715*^9, 3.739883951014722*^9, 
   3.7398840851989326`*^9, 3.7398842388876257`*^9, {3.739884304883816*^9, 
   3.73988434421486*^9}, 3.739884422326973*^9, 3.739884548158079*^9, 
   3.739884623112905*^9, 3.7398846931312943`*^9, 3.739884746580182*^9, 
   3.739884794190772*^9, 3.739884836762892*^9, 3.7398851397407017`*^9, 
   3.7398853059409943`*^9, 3.73988537148225*^9, {3.739885413373145*^9, 
   3.739885450727726*^9}, {3.7398854900180483`*^9, 3.7398855025250587`*^9}, {
   3.739885552344411*^9, 3.739885575330546*^9}, 3.739885653860388*^9, 
   3.7398857242955227`*^9, 3.7398857580269823`*^9, 3.739886141990543*^9, 
   3.7398863597189093`*^9, 3.7398863916350737`*^9, 3.7398864296068363`*^9, 
   3.739972922612268*^9, {3.739974907112761*^9, 3.739974926197824*^9}}]
}, Open  ]]
},
WindowSize->{808, 1030},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
FrontEndVersion->"10.0 for Linux x86 (64-bit) (June 27, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 6534, 143, 627, "Input"],
Cell[7117, 167, 1106, 19, 32, "Output"],
Cell[8226, 188, 1580, 32, 55, "Output"],
Cell[9809, 222, 1226, 22, 32, "Output"],
Cell[11038, 246, 1543, 31, 55, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
